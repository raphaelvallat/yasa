<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>yasa.SpindlesResults &#8212; yasa 0.6.2 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><span><img src="../_static/yasa_128x128.png"></span>
          yasa</a>
        <span class="navbar-text navbar-version pull-left"><b>0.6.2</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../api.html">API</a></li>
                <li><a href="../quickstart.html">Quickstart</a></li>
                <li><a href="../faq.html">FAQ</a></li>
                <li><a href="../changelog.html">What's new</a></li>
                <li><a href="../contributing.html">Contribute</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="section" id="yasa-spindlesresults">
<h1>yasa.SpindlesResults<a class="headerlink" href="#yasa-spindlesresults" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="yasa.SpindlesResults">
<em class="property">class </em><code class="sig-prename descclassname">yasa.</code><code class="sig-name descname">SpindlesResults</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">events</span></em>, <em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">sf</span></em>, <em class="sig-param"><span class="n">ch_names</span></em>, <em class="sig-param"><span class="n">hypno</span></em>, <em class="sig-param"><span class="n">data_filt</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/yasa/detection.html#SpindlesResults"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#yasa.SpindlesResults" title="Permalink to this definition">¶</a></dt>
<dd><p>Output class for spindles detection.</p>
<dl class="field-list">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl>
<dt><strong>_events</strong><span class="classifier"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.4.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a></span></dt><dd><p>Output detection dataframe</p>
</dd>
<dt><strong>_data</strong><span class="classifier">array_like</span></dt><dd><p>Original EEG data of shape <em>(n_chan, n_samples)</em>.</p>
</dd>
<dt><strong>_data_filt</strong><span class="classifier">array_like</span></dt><dd><p>Sigma-filtered EEG data of shape <em>(n_chan, n_samples)</em>.</p>
</dd>
<dt><strong>_sf</strong><span class="classifier">float</span></dt><dd><p>Sampling frequency of data.</p>
</dd>
<dt><strong>_ch_names</strong><span class="classifier">list</span></dt><dd><p>Channel names.</p>
</dd>
<dt><strong>_hypno</strong><span class="classifier">array_like or None</span></dt><dd><p>Sleep staging vector.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="yasa.SpindlesResults.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">events</span></em>, <em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">sf</span></em>, <em class="sig-param"><span class="n">ch_names</span></em>, <em class="sig-param"><span class="n">hypno</span></em>, <em class="sig-param"><span class="n">data_filt</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/yasa/detection.html#SpindlesResults.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#yasa.SpindlesResults.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#yasa.SpindlesResults.__init__" title="yasa.SpindlesResults.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(events, data, sf, ch_names, hypno, …)</p></td>
<td><p>Initialize self.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#yasa.SpindlesResults.compare_channels" title="yasa.SpindlesResults.compare_channels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compare_channels</span></code></a>([score, max_distance_sec])</p></td>
<td><p>Compare detected spindles across channels.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#yasa.SpindlesResults.compare_detection" title="yasa.SpindlesResults.compare_detection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compare_detection</span></code></a>(other[, max_distance_sec, …])</p></td>
<td><p>Compare the detected spindles against either another YASA detection or against custom annotations (e.g.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#yasa.SpindlesResults.get_coincidence_matrix" title="yasa.SpindlesResults.get_coincidence_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_coincidence_matrix</span></code></a>([scaled])</p></td>
<td><p>Return the (scaled) coincidence matrix.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#yasa.SpindlesResults.get_mask" title="yasa.SpindlesResults.get_mask"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_mask</span></code></a>()</p></td>
<td><p>Return a boolean array indicating for each sample in data if this sample is part of a detected event (True) or not (False).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#yasa.SpindlesResults.get_sync_events" title="yasa.SpindlesResults.get_sync_events"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_sync_events</span></code></a>([center, time_before, …])</p></td>
<td><p>Return the raw or filtered data of each detected event after centering to a specific timepoint.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#yasa.SpindlesResults.plot_average" title="yasa.SpindlesResults.plot_average"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_average</span></code></a>([center, hue, time_before, …])</p></td>
<td><p>Plot the average spindle.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#yasa.SpindlesResults.plot_detection" title="yasa.SpindlesResults.plot_detection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_detection</span></code></a>()</p></td>
<td><p>Plot an overlay of the detected spindles on the EEG signal.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#yasa.SpindlesResults.summary" title="yasa.SpindlesResults.summary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code></a>([grp_chan, grp_stage, mask, …])</p></td>
<td><p>Return a summary of the spindles detection, optionally grouped across channels and/or stage.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="yasa.SpindlesResults.compare_channels">
<code class="sig-name descname">compare_channels</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">score</span><span class="o">=</span><span class="default_value">'f1'</span></em>, <em class="sig-param"><span class="n">max_distance_sec</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/yasa/detection.html#SpindlesResults.compare_channels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#yasa.SpindlesResults.compare_channels" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare detected spindles across channels.</p>
<p>This is a wrapper around the <a class="reference internal" href="yasa.compare_detection.html#yasa.compare_detection" title="yasa.compare_detection"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.compare_detection()</span></code></a> function. Please
refer to the documentation of this function for more details.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>score</strong><span class="classifier">str</span></dt><dd><p>The performance metric to compute. Accepted values are “precision”, “recall”
(aka sensitivity) and “f1” (default). The F1-score is the harmonic mean of precision
and recall, and is usually the preferred metric to evaluate the agreement between
two channels. All three metrics are bounded by 0 and 1, where 1 indicates perfect
agreement.</p>
</dd>
<dt><strong>max_distance_sec</strong><span class="classifier">float</span></dt><dd><p>The maximum distance between spindles, in seconds, to consider as the same event.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>To reduce computation cost, YASA rounds the start time of each spindle to
the nearest decisecond (= 100 ms). This means that the lowest possible resolution
is 100 ms, regardless of the sampling frequency of the data. Two spindles starting
at 500 ms and 540 ms on their respective channels will therefore always be
considered the same event, even when max_distance_sec=0.</p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>scores</strong><span class="classifier"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.4.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a></span></dt><dd><p>A Pandas DataFrame with the output scores, of shape (n_chan, n_chan).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Some use cases of this function:</p>
<ol class="arabic simple">
<li><p>What proportion of spindles detected in one channel are also detected on
another channel (if using <code class="docutils literal notranslate"><span class="pre">score=&quot;recall&quot;</span></code>).</p></li>
<li><p>What is the overall agreement in the detected events between channels?</p></li>
<li><p>Is the agreement better in channels that are close to one another?</p></li>
</ol>
</dd></dl>

<dl class="py method">
<dt id="yasa.SpindlesResults.compare_detection">
<code class="sig-name descname">compare_detection</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em>, <em class="sig-param"><span class="n">max_distance_sec</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">other_is_groundtruth</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/yasa/detection.html#SpindlesResults.compare_detection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#yasa.SpindlesResults.compare_detection" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare the detected spindles against either another YASA detection or against custom
annotations (e.g. ground-truth human scoring).</p>
<p>This function is a wrapper around the <a class="reference internal" href="yasa.compare_detection.html#yasa.compare_detection" title="yasa.compare_detection"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.compare_detection()</span></code></a> function. Please
refer to the documentation of this function for more details.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>other</strong><span class="classifier">dataframe or detection results</span></dt><dd><p>This can be either a) the output of another YASA detection, for example if you want to
test the impact of tweaking some parameters on the detected events or b) a pandas
DataFrame with custom annotations, obtained by another detection method outside
of YASA, or with manual labelling. If b), the dataframe must contain the “Start” and
“Channel” columns, with the start of each event in seconds from the beginning
of the recording and the channel name, respectively. The channel names should match
the output of the summary() method.</p>
</dd>
<dt><strong>max_distance_sec</strong><span class="classifier">float</span></dt><dd><p>The maximum distance between spindles, in seconds, to consider as the same event.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>To reduce computation cost, YASA rounds the start time of each spindle to
the nearest decisecond (= 100 ms). This means that the lowest possible resolution
is 100 ms, regardless of the sampling frequency of the data.</p>
</div>
</dd>
<dt><strong>other_is_groundtruth</strong><span class="classifier">bool</span></dt><dd><p>If True (default), <code class="docutils literal notranslate"><span class="pre">other</span></code> will be considered as the ground-truth scoring. If False,
the current detection will be considered as the ground-truth, and the precision and
recall scores will be inverted. This parameter has no effect on the F1-score.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>when <code class="docutils literal notranslate"><span class="pre">other</span></code> is the ground-truth (default), the recall score is the
fraction of events in other that were succesfully detected by the current
detection, and the precision score is the proportion of detected events by the
current detection that are also present in other.</p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>scores</strong><span class="classifier"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.4.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a></span></dt><dd><p>A Pandas DataFrame with the channel names as index, and the following columns</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">precision</span></code>: Precision score, aka positive predictive value</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">recall</span></code>: Recall score, aka sensitivity</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f1</span></code>: F1-score</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n_self</span></code>: Number of detected events in <code class="docutils literal notranslate"><span class="pre">self</span></code> (current method).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n_other</span></code>: Number of detected events in <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Some use cases of this function:</p>
<ol class="arabic simple">
<li><p>How well does YASA events detection perform against ground-truth human annotations?</p></li>
<li><p>If I change the threshold(s) of the events detection, do the detected events match
those obtained with the default parameters?</p></li>
<li><p>Which detection thresholds give the highest agreement with the ground-truth scoring?</p></li>
</ol>
</dd></dl>

<dl class="py method">
<dt id="yasa.SpindlesResults.get_coincidence_matrix">
<code class="sig-name descname">get_coincidence_matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">scaled</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/yasa/detection.html#SpindlesResults.get_coincidence_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#yasa.SpindlesResults.get_coincidence_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (scaled) coincidence matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>scaled</strong><span class="classifier">bool</span></dt><dd><p>If True (default), the coincidence matrix is scaled (see Notes).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>coincidence</strong><span class="classifier">pd.DataFrame</span></dt><dd><p>A symmetric matrix with the (scaled) coincidence values.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Do spindles occur at the same time? One way to measure this is to
calculate the coincidence matrix, which gives, for each pair of
channel, the number of samples that were marked as a spindle in both
channels. The output is a symmetric matrix, in which the diagonal is
simply the number of data points that were marked as a spindle in the
channel.</p>
<p>The coincidence matrix can be scaled (default) by dividing the output
by the product of the sum of each individual binary mask, as shown in
the example below. It can then be used to define functional
networks or quickly find outlier channels.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/Mark-Kramer/Sleep-Networks-2021">https://github.com/Mark-Kramer/Sleep-Networks-2021</a></p></li>
</ul>
<p class="rubric">Examples</p>
<p>Calculate the coincidence of two binary mask:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">*</span> <span class="n">y</span>
<span class="go">array([0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># Unscaled coincidence</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">*</span> <span class="n">y</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>  <span class="c1"># Scaled coincidence</span>
<span class="go">0.12</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="yasa.SpindlesResults.get_mask">
<code class="sig-name descname">get_mask</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/yasa/detection.html#SpindlesResults.get_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#yasa.SpindlesResults.get_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a boolean array indicating for each sample in data if this
sample is part of a detected event (True) or not (False).</p>
</dd></dl>

<dl class="py method">
<dt id="yasa.SpindlesResults.get_sync_events">
<code class="sig-name descname">get_sync_events</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">center</span><span class="o">=</span><span class="default_value">'Peak'</span></em>, <em class="sig-param"><span class="n">time_before</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">time_after</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">filt</span><span class="o">=</span><span class="default_value">None, None</span></em>, <em class="sig-param"><span class="n">mask</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">as_dataframe</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/yasa/detection.html#SpindlesResults.get_sync_events"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#yasa.SpindlesResults.get_sync_events" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the raw or filtered data of each detected event after
centering to a specific timepoint.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>center</strong><span class="classifier">str</span></dt><dd><p>Landmark of the event to synchronize the timing on.
Default is to use the center peak of the spindles.</p>
</dd>
<dt><strong>time_before</strong><span class="classifier">float</span></dt><dd><p>Time (in seconds) before <code class="docutils literal notranslate"><span class="pre">center</span></code>.</p>
</dd>
<dt><strong>time_after</strong><span class="classifier">float</span></dt><dd><p>Time (in seconds) after <code class="docutils literal notranslate"><span class="pre">center</span></code>.</p>
</dd>
<dt><strong>filt</strong><span class="classifier">tuple</span></dt><dd><p>Optional filtering to apply to data. For instance, <code class="docutils literal notranslate"><span class="pre">filt=(1,</span> <span class="pre">30)</span></code>
will apply a 1 to 30 Hz bandpass filter, and <code class="docutils literal notranslate"><span class="pre">filt=(None,</span> <span class="pre">40)</span></code>
will apply a 40 Hz lowpass filter. Filtering is done using default
parameters in the <a class="reference external" href="https://mne.tools/stable/generated/mne.filter.filter_data.html#mne.filter.filter_data" title="(in MNE v1.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.filter.filter_data()</span></code></a> function.</p>
</dd>
<dt><strong>mask</strong><span class="classifier">array_like or None</span></dt><dd><p>Custom boolean mask. Only the detected events for which mask is True will be
included. Default is None, i.e. no masking (all events are included).</p>
</dd>
<dt><strong>as_dataframe</strong><span class="classifier">boolean</span></dt><dd><p>If True (default), returns a long-format pandas dataframe. If False, returns a list of
numpy arrays. Each element of the list a unique channel, and the shape of the numpy
arrays within the list is (n_events, n_times).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>df_sync</strong><span class="classifier"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.4.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a></span></dt><dd><p>Ouput long-format dataframe (if <code class="docutils literal notranslate"><span class="pre">as_dataframe=True</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;Event&#39;</span> <span class="p">:</span> <span class="n">Event</span> <span class="n">number</span>
<span class="s1">&#39;Time&#39;</span> <span class="p">:</span> <span class="n">Timing</span> <span class="n">of</span> <span class="n">the</span> <span class="n">events</span> <span class="p">(</span><span class="ow">in</span> <span class="n">seconds</span><span class="p">)</span>
<span class="s1">&#39;Amplitude&#39;</span> <span class="p">:</span> <span class="n">Raw</span> <span class="ow">or</span> <span class="n">filtered</span> <span class="n">data</span> <span class="k">for</span> <span class="n">event</span>
<span class="s1">&#39;Channel&#39;</span> <span class="p">:</span> <span class="n">Channel</span>
<span class="s1">&#39;IdxChannel&#39;</span> <span class="p">:</span> <span class="n">Index</span> <span class="n">of</span> <span class="n">channel</span> <span class="ow">in</span> <span class="n">data</span>
<span class="s1">&#39;Stage&#39;</span><span class="p">:</span> <span class="n">Sleep</span> <span class="n">stage</span> <span class="ow">in</span> <span class="n">which</span> <span class="n">the</span> <span class="n">events</span> <span class="n">occured</span> <span class="p">(</span><span class="k">if</span> <span class="n">available</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="yasa.SpindlesResults.plot_average">
<code class="sig-name descname">plot_average</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">center</span><span class="o">=</span><span class="default_value">'Peak'</span></em>, <em class="sig-param"><span class="n">hue</span><span class="o">=</span><span class="default_value">'Channel'</span></em>, <em class="sig-param"><span class="n">time_before</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">time_after</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">filt</span><span class="o">=</span><span class="default_value">None, None</span></em>, <em class="sig-param"><span class="n">mask</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">6, 4.5</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/yasa/detection.html#SpindlesResults.plot_average"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#yasa.SpindlesResults.plot_average" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the average spindle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>center</strong><span class="classifier">str</span></dt><dd><p>Landmark of the event to synchronize the timing on.
Default is to use the most prominent peak of the spindle.</p>
</dd>
<dt><strong>hue</strong><span class="classifier">str</span></dt><dd><p>Grouping variable that will produce lines with different colors.
Can be either ‘Channel’ or ‘Stage’.</p>
</dd>
<dt><strong>time_before</strong><span class="classifier">float</span></dt><dd><p>Time (in seconds) before <code class="docutils literal notranslate"><span class="pre">center</span></code>.</p>
</dd>
<dt><strong>time_after</strong><span class="classifier">float</span></dt><dd><p>Time (in seconds) after <code class="docutils literal notranslate"><span class="pre">center</span></code>.</p>
</dd>
<dt><strong>filt</strong><span class="classifier">tuple</span></dt><dd><p>Optional filtering to apply to data. For instance, <code class="docutils literal notranslate"><span class="pre">filt=(12,</span> <span class="pre">16)</span></code>
will apply a 12 to 16 Hz bandpass filter, and <code class="docutils literal notranslate"><span class="pre">filt=(None,</span> <span class="pre">40)</span></code>
will apply a 40 Hz lowpass filter. Filtering is done using the default
parameters in the <a class="reference external" href="https://mne.tools/stable/generated/mne.filter.filter_data.html#mne.filter.filter_data" title="(in MNE v1.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.filter.filter_data()</span></code></a> function.</p>
</dd>
<dt><strong>mask</strong><span class="classifier">array_like or None</span></dt><dd><p>Custom boolean mask. Only the detected events for which mask is True will be
plotted. Default is None, i.e. no masking (all events are included).</p>
</dd>
<dt><strong>figsize</strong><span class="classifier">tuple</span></dt><dd><p>Figure size in inches.</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">dict</span></dt><dd><p>Optional argument that are passed to <a class="reference external" href="https://seaborn.pydata.org/generated/seaborn.lineplot.html#seaborn.lineplot" title="(in seaborn v0.11.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">seaborn.lineplot()</span></code></a>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="yasa.SpindlesResults.plot_detection">
<code class="sig-name descname">plot_detection</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/yasa/detection.html#SpindlesResults.plot_detection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#yasa.SpindlesResults.plot_detection" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot an overlay of the detected spindles on the EEG signal.</p>
<p>This only works in Jupyter and it requires the ipywidgets
(<a class="reference external" href="https://ipywidgets.readthedocs.io/en/latest/">https://ipywidgets.readthedocs.io/en/latest/</a>) package.</p>
<p>To activate the interactive mode, make sure to run:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">widget</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.4.0.</span></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="yasa.SpindlesResults.summary">
<code class="sig-name descname">summary</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">grp_chan</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">grp_stage</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">mask</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">aggfunc</span><span class="o">=</span><span class="default_value">'mean'</span></em>, <em class="sig-param"><span class="n">sort</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/yasa/detection.html#SpindlesResults.summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#yasa.SpindlesResults.summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a summary of the spindles detection, optionally grouped
across channels and/or stage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>grp_chan</strong><span class="classifier">bool</span></dt><dd><p>If True, group by channel (for multi-channels detection only).</p>
</dd>
<dt><strong>grp_stage</strong><span class="classifier">bool</span></dt><dd><p>If True, group by sleep stage (provided that an hypnogram was
used).</p>
</dd>
<dt><strong>mask</strong><span class="classifier">array_like or None</span></dt><dd><p>Custom boolean mask. Only the detected events for which mask is True will be
included in the summary dataframe. Default is None, i.e. no masking
(all events are included).</p>
</dd>
<dt><strong>aggfunc</strong><span class="classifier">str or function</span></dt><dd><p>Averaging function (e.g. <code class="docutils literal notranslate"><span class="pre">'mean'</span></code> or <code class="docutils literal notranslate"><span class="pre">'median'</span></code>).</p>
</dd>
<dt><strong>sort</strong><span class="classifier">bool</span></dt><dd><p>If True, sort group keys when grouping.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
        &copy; Copyright 2018-2022, Dr. Raphael Vallat, Center for Human Sleep Science, UC Berkeley.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>