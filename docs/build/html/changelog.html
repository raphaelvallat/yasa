<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>What’s new &#8212; yasa 0.6.2 documentation</title>
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="_static/js/jquery-1.12.4.min.js "></script>
<script type="text/javascript" src="_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="_static/bootstrap-3.4.1/js/bootstrap.min.js "></script>
<script type="text/javascript" src="_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html"><span><img src="_static/yasa_128x128.png"></span>
          yasa</a>
        <span class="navbar-text navbar-version pull-left"><b>0.6.2</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="api.html">API</a></li>
                <li><a href="quickstart.html">Quickstart</a></li>
                <li><a href="faq.html">FAQ</a></li>
                <li><a href="#">What's new</a></li>
                <li><a href="contributing.html">Contribute</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="section" id="what-s-new">
<span id="changelog"></span><h1><a class="toc-backref" href="#id8">What’s new</a><a class="headerlink" href="#what-s-new" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#what-s-new" id="id8">What’s new</a></p>
<ul>
<li><p><a class="reference internal" href="#v0-6-2-august-2022" id="id9">v0.6.2 (August 2022)</a></p></li>
<li><p><a class="reference internal" href="#v0-6-1-march-2022" id="id10">v0.6.1 (March 2022)</a></p></li>
<li><p><a class="reference internal" href="#v0-6-0-february-2022" id="id11">v0.6.0 (February 2022)</a></p></li>
<li><p><a class="reference internal" href="#v0-5-1-august-2021" id="id12">v0.5.1 (August 2021)</a></p></li>
<li><p><a class="reference internal" href="#v0-5-0-august-2021" id="id13">v0.5.0 (August 2021)</a></p></li>
<li><p><a class="reference internal" href="#v0-4-1-march-2021" id="id14">v0.4.1 (March 2021)</a></p></li>
<li><p><a class="reference internal" href="#v0-4-0-november-2020" id="id15">v0.4.0 (November 2020)</a></p></li>
<li><p><a class="reference internal" href="#v0-3-0-may-2020" id="id16">v0.3.0 (May 2020)</a></p></li>
<li><p><a class="reference internal" href="#older-versions" id="id17">Older versions</a></p></li>
</ul>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="v0-6-2-august-2022">
<h2><a class="toc-backref" href="#id9">v0.6.2 (August 2022)</a><a class="headerlink" href="#v0-6-2-august-2022" title="Permalink to this headline">¶</a></h2>
<p><strong>ECG analysis</strong> - <a class="reference external" href="https://github.com/raphaelvallat/yasa/pull/68">PR 68</a></p>
<ol class="loweralpha simple">
<li><p>Added the <a class="reference internal" href="generated/yasa.hypno_find_periods.html#yasa.hypno_find_periods" title="yasa.hypno_find_periods"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.hypno_find_periods()</span></code></a> function to find sequences of consecutive values in hypnogram that are longer than a certain duration. This is a flexible function that can be used to detect NREM/REM periods.</p></li>
<li><p>Added the <a class="reference internal" href="generated/yasa.hrv_stage.html#yasa.hrv_stage" title="yasa.hrv_stage"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.hrv_stage()</span></code></a> function, which calculates heart rate (HR) and heart rate variability (HRV) by stage and periods.</p></li>
<li><p>Added a new dataset containing 8 hours of ECG data. The dataset is in compressed NumPy format and can be found in notebooks/data_ECG_8hrs_200Hz.npz. The dataset also includes an upsampled hypnogram.</p></li>
<li><p>Added a new Jupyter notebook to calculate EEG-HRV overnight coupling based on the <a class="reference internal" href="generated/yasa.hrv_stage.html#yasa.hrv_stage" title="yasa.hrv_stage"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.hrv_stage()</span></code></a> function. <a class="reference external" href="https://github.com/raphaelvallat/yasa/blob/master/notebooks/16_EEG-HRV_coupling.ipynb">https://github.com/raphaelvallat/yasa/blob/master/notebooks/16_EEG-HRV_coupling.ipynb</a></p></li>
</ol>
<p><strong>Spindles &amp; slow-waves detection</strong> - <a class="reference external" href="https://github.com/raphaelvallat/yasa/pull/71">PR 71</a></p>
<ol class="loweralpha simple">
<li><p>Added the <a class="reference internal" href="generated/yasa.compare_detection.html#yasa.compare_detection" title="yasa.compare_detection"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.compare_detection()</span></code></a> function to determine the correctness of detected events against ground-truth events. It calculates the true positive, false positives and false negatives, and from those, the precision, recall and F1-scores. The input should be the indices of the onset of the event, in samples. It includes a max_distance argument which specifies the tolerance window (in number of samples) for two events to be considered the same.</p></li>
<li><p>Added the <a class="reference internal" href="generated/yasa.SpindlesResults.html#yasa.SpindlesResults.compare_detection" title="yasa.SpindlesResults.compare_detection"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yasa.SpindlesResults.compare_detection()</span></code></a> and <a class="reference internal" href="generated/yasa.SWResults.html#yasa.SWResults.compare_detection" title="yasa.SWResults.compare_detection"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yasa.SWResults.compare_detection()</span></code></a> method. This is a powerful and flexible function that allows to calculate the performance of the current detection against a) another detection or b) ground-truth annotations. For example, we can compare the output of the spindles detection with different thresholds.</p></li>
<li><p>Added the <a class="reference internal" href="generated/yasa.SpindlesResults.html#yasa.SpindlesResults.compare_channels" title="yasa.SpindlesResults.compare_channels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yasa.SpindlesResults.compare_channels()</span></code></a> and <a class="reference internal" href="generated/yasa.SWResults.html#yasa.SWResults.compare_channels" title="yasa.SWResults.compare_channels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yasa.SWResults.compare_channels()</span></code></a> methods to compare the overlap of the detected events between channels. Agreement is calculated using the F1-score (default), precision or recall.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">vmin</span></code> and <code class="docutils literal notranslate"><span class="pre">vmax</span></code> parameters to <a class="reference internal" href="generated/yasa.plot_spectrogram.html#yasa.plot_spectrogram" title="yasa.plot_spectrogram"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.plot_spectrogram()</span></code></a>. <a class="reference external" href="https://github.com/raphaelvallat/yasa/pull/75">PR 75</a></p></li>
<li><p>Better handling of flat data in <a class="reference internal" href="generated/yasa.spindles_detect.html#yasa.spindles_detect" title="yasa.spindles_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.spindles_detect()</span></code></a>. The function previously returned a division by zero error if part of the data was flat. See <a class="reference external" href="https://github.com/raphaelvallat/yasa/issues/85">issue 85</a></p></li>
<li><p>When using an MNE.Raw object, conversion of the data from Volts to micro-Volts is now performed within MNE. <a class="reference external" href="https://github.com/raphaelvallat/yasa/pull/70">PR 70</a></p></li>
<li><p>Use <a class="reference external" href="https://black.readthedocs.io/en/stable/">black</a> code formatting.</p></li>
</ol>
<p><strong>Others</strong></p>
<ol class="loweralpha simple">
<li><p>When using an MNE.Raw object, conversion of the data from Volts to micro-Volts is now performed within MNE. <a class="reference external" href="https://github.com/raphaelvallat/yasa/pull/70">PR 70</a></p></li>
<li><p>Added <a class="reference external" href="https://sleepecg.readthedocs.io/en/stable/">SleepECG</a> to the dependencies. SleepECG is used for the heartbeats detection in <a class="reference internal" href="generated/yasa.hrv_stage.html#yasa.hrv_stage" title="yasa.hrv_stage"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.hrv_stage()</span></code></a>.</p></li>
<li><p>YASA now requires MNE&gt;0.23</p></li>
</ol>
</div>
<hr class="docutils" />
<div class="section" id="v0-6-1-march-2022">
<h2><a class="toc-backref" href="#id10">v0.6.1 (March 2022)</a><a class="headerlink" href="#v0-6-1-march-2022" title="Permalink to this headline">¶</a></h2>
<p>This release fixes a CRITICAL BUG with the spindles detection. Specifically, the <a class="reference internal" href="generated/yasa.spindles_detect.html#yasa.spindles_detect" title="yasa.spindles_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.spindles_detect()</span></code></a> could return different results depending on the sampling rate of the data.
For example, downsampling the data from 256 Hz to 128 Hz may have significantly reduced the number of detected spindles. As explained in <a class="reference external" href="https://github.com/raphaelvallat/yasa/issues/54">issue 54</a>, this bug was caused by a floating-point error
in <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.convolve.html#numpy.convolve" title="(in NumPy v1.23)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.convolve()</span></code></a> when calculating the soft spindle threshold. Tests seem to indicate that only certain sampling frequencies were impacted, such as 200 Hz, 256 Hz or 400 Hz. Other sampling frequencies such as 100 Hz and 500 Hz were seemingly not affected by this bug. Please double-check any results obtained with <a class="reference internal" href="generated/yasa.spindles_detect.html#yasa.spindles_detect" title="yasa.spindles_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.spindles_detect()</span></code></a>!</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>We recommend all users to upgrade to this new version ASAP and check any results obtained with the <a class="reference internal" href="generated/yasa.spindles_detect.html#yasa.spindles_detect" title="yasa.spindles_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.spindles_detect()</span></code></a> function!</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="v0-6-0-february-2022">
<h2><a class="toc-backref" href="#id11">v0.6.0 (February 2022)</a><a class="headerlink" href="#v0-6-0-february-2022" title="Permalink to this headline">¶</a></h2>
<p>This is a MAJOR release with several API-breaking changes, new functions, bugfixes and a new section in the documentation.</p>
<p><strong>Documentation</strong></p>
<ul class="simple">
<li><p>Added a <a class="reference internal" href="quickstart.html#quickstart"><span class="std std-ref">Quickstart</span></a> section to illustrate the main functions of YASA. Make sure to check it out!</p></li>
</ul>
<p><strong>Plotting</strong></p>
<ul class="simple">
<li><p>Added the <a class="reference internal" href="generated/yasa.plot_hypnogram.html#yasa.plot_hypnogram" title="yasa.plot_hypnogram"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.plot_hypnogram()</span></code></a> function to plot an hypnogram.</p></li>
</ul>
<p><strong>Slow oscillations—sigma coupling</strong></p>
<p>IMPORTANT — The default behavior of <code class="docutils literal notranslate"><span class="pre">coupling=True</span></code> in <a class="reference internal" href="generated/yasa.sw_detect.html#yasa.sw_detect" title="yasa.sw_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.sw_detect()</span></code></a> has been changed:</p>
<ul class="simple">
<li><p>YASA now uses a ± 1 second window around the negative peak of the slow-waves (2 sec total) to calculate the coupling, instead of a ± 2 sec window. Overall, this tends to increase the ndPAC values because of the higher temporal specificity. To keep a 4-sec window, use <code class="docutils literal notranslate"><span class="pre">coupling_params['time']</span> <span class="pre">=</span> <span class="pre">2</span></code>.</p></li>
<li><p>We’ve enabled the statistical thresholding in the ndPAC calculation. Practically, this means that events with a weak/unreliable coupling are assigned an ndPAC value of zero. Statistical thresholding can be disabled with <code class="docutils literal notranslate"><span class="pre">coupling_params['p']</span> <span class="pre">=</span> <span class="pre">None</span></code>.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Because of these changes, the coupling values are therefore not comparable with previous versions of YASA. Please make sure to re-run your analyses with the new default parameters.</p>
</div>
<p><strong>Events detection</strong></p>
<ul class="simple">
<li><p>The <a class="reference internal" href="generated/yasa.sw_detect.html#yasa.sw_detect" title="yasa.sw_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.sw_detect()</span></code></a> function now uses more conservative amplitude thresholds: the max PTP amplitude has been reduced from 500 to 350 uV, the max negative amplitude has been reduced from 300 to 200 uV, and the max positive amplitude has been reduced from 200 to 150 uV.</p></li>
<li><p>Added <a class="reference internal" href="generated/yasa.SWResults.html#yasa.SWResults.find_cooccurring_spindles" title="yasa.SWResults.find_cooccurring_spindles"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yasa.SWResults.find_cooccurring_spindles()</span></code></a> to detect whether each slow-wave co-occurr with a sleep spindle.</p></li>
<li><p>Added the <code class="docutils literal notranslate"><span class="pre">as_dataframe</span></code> parameter in <a class="reference internal" href="generated/yasa.SWResults.html#yasa.SWResults.get_sync_events" title="yasa.SWResults.get_sync_events"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yasa.SWResults.get_sync_events()</span></code></a> and <a class="reference internal" href="generated/yasa.SpindlesResults.html#yasa.SpindlesResults.get_sync_events" title="yasa.SpindlesResults.get_sync_events"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yasa.SpindlesResults.get_sync_events()</span></code></a>. If set to False, YASA will return the peak-locked data as a list (n_channels) of numpy arrays (n_events, n_times). This facilitates any analyses that requires access to event-locked data (e.g. time-frequency plot, or comodulogram).</p></li>
<li><p>Added the <code class="docutils literal notranslate"><span class="pre">mask</span></code> parameter in <a class="reference internal" href="generated/yasa.SWResults.html#yasa.SWResults.summary" title="yasa.SWResults.summary"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yasa.SWResults.summary()</span></code></a>, <a class="reference internal" href="generated/yasa.SWResults.html#yasa.SWResults.get_sync_events" title="yasa.SWResults.get_sync_events"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yasa.SWResults.get_sync_events()</span></code></a>, and <a class="reference internal" href="generated/yasa.SWResults.html#yasa.SWResults.plot_average" title="yasa.SWResults.plot_average"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yasa.SWResults.plot_average()</span></code></a>. This allows users to only include selected events in the summary or plots (e.g. the slow-waves with the largest peak-to-peak amplitude, or strongest coupling).</p></li>
<li><p>Added the <code class="docutils literal notranslate"><span class="pre">mask</span></code> parameter in <a class="reference internal" href="generated/yasa.SpindlesResults.html#yasa.SpindlesResults.summary" title="yasa.SpindlesResults.summary"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yasa.SpindlesResults.summary()</span></code></a>, <a class="reference internal" href="generated/yasa.SpindlesResults.html#yasa.SpindlesResults.get_sync_events" title="yasa.SpindlesResults.get_sync_events"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yasa.SpindlesResults.get_sync_events()</span></code></a>, and <a class="reference internal" href="generated/yasa.SpindlesResults.html#yasa.SpindlesResults.plot_average" title="yasa.SpindlesResults.plot_average"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yasa.SpindlesResults.plot_average()</span></code></a>. This allows users to only include selected events in the summary or plots (e.g. the spindles with the largest amplitude).</p></li>
<li><p>Added the <code class="docutils literal notranslate"><span class="pre">mask</span></code> parameter in <a class="reference internal" href="generated/yasa.REMResults.html#yasa.REMResults.summary" title="yasa.REMResults.summary"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yasa.REMResults.summary()</span></code></a>, <a class="reference internal" href="generated/yasa.REMResults.html#yasa.REMResults.get_sync_events" title="yasa.REMResults.get_sync_events"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yasa.REMResults.get_sync_events()</span></code></a>, and <a class="reference internal" href="generated/yasa.REMResults.html#yasa.REMResults.plot_average" title="yasa.REMResults.plot_average"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yasa.REMResults.plot_average()</span></code></a>.</p></li>
</ul>
<p><strong>Others</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="generated/yasa.irasa.html#yasa.irasa" title="yasa.irasa"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.irasa()</span></code></a> now informs about the maximum resampled fitting range, and raises a warning if parameters/frequencies are ill-specified. See <a class="reference external" href="https://github.com/raphaelvallat/yasa/pull/42">PR42</a> and associated paper: <a class="reference external" href="https://doi.org/10.1101/2021.10.15.464483">https://doi.org/10.1101/2021.10.15.464483</a></p></li>
<li><p>Added a <code class="docutils literal notranslate"><span class="pre">verbose</span></code> parameter to <a class="reference internal" href="generated/yasa.hypno_upsample_to_data.html#yasa.hypno_upsample_to_data" title="yasa.hypno_upsample_to_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.hypno_upsample_to_data()</span></code></a> and <a class="reference internal" href="generated/yasa.irasa.html#yasa.irasa" title="yasa.irasa"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.irasa()</span></code></a>.</p></li>
<li><p>Remove Travis CI</p></li>
<li><p>Remove CI testing for Python 3.6</p></li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="v0-5-1-august-2021">
<h2><a class="toc-backref" href="#id12">v0.5.1 (August 2021)</a><a class="headerlink" href="#v0-5-1-august-2021" title="Permalink to this headline">¶</a></h2>
<p>This is a bugfix release. The latest pre-trained classifiers for <a class="reference internal" href="generated/yasa.SleepStaging.html#yasa.SleepStaging" title="yasa.SleepStaging"><code class="xref py py-class docutils literal notranslate"><span class="pre">yasa.SleepStaging</span></code></a> were accidentally missing from the previous release. They have now been included in this release.</p>
</div>
<hr class="docutils" />
<div class="section" id="v0-5-0-august-2021">
<h2><a class="toc-backref" href="#id13">v0.5.0 (August 2021)</a><a class="headerlink" href="#v0-5-0-august-2021" title="Permalink to this headline">¶</a></h2>
<p>This is a major release with an important bugfix for the slow-waves detection as well as API-breaking changes in the automatic sleep staging module. We recommend all users to upgrade to this version with <cite>pip install –upgrade yasa</cite>.</p>
<p><strong>Slow-waves detection</strong></p>
<p>We have fixed a critical bug in <a class="reference internal" href="generated/yasa.sw_detect.html#yasa.sw_detect" title="yasa.sw_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.sw_detect()</span></code></a> in which the detection could keep slow-waves with invalid duration (e.g. several tens of seconds). We have now added extra safety checks to make sure that the total duration of the slow-waves does not exceed the maximum duration allowed by the <code class="docutils literal notranslate"><span class="pre">dur_neg</span></code> and <code class="docutils literal notranslate"><span class="pre">dur_pos</span></code> parameters (default = 2.5 seconds).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Please make sure to double-check any results obtained with <a class="reference internal" href="generated/yasa.sw_detect.html#yasa.sw_detect" title="yasa.sw_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.sw_detect()</span></code></a>.</p>
</div>
<p><strong>Sleep staging</strong></p>
<p>Recently, we have published a <a class="reference external" href="https://www.biorxiv.org/content/10.1101/2021.05.28.446165v1">preprint article</a> describing YASA’s sleep staging algorithm and its validation across hundreds of polysomnography recordings. In July 2021, we have received comments from three reviewers, which have led us to implement several changes to the sleep staging algorithm.
The most significant change is that the time lengths of the rolling windows have been updated from 5.5 minutes centered / 5 minutes past to 7.5 minutes centered / 2 min past, leading to slight improvements in accuracy. Furthermore, we have also updated the training database and the parameters of the LightGBM classifier.
Unfortunately, these changes mean that the new version of the algorithm is no longer compatible with the previous version (0.4.0 or 0.4.1). Therefore, if you’re running a longitudinal study with YASA’s sleep staging, we either recommend to keep the previous version of YASA, or to update to the new version and reprocess all your nights with the new algorithm for consistency.</p>
<p><strong>Sleep statistics</strong></p>
<p>Artefact and Unscored epochs are now excluded from the calculation of the total sleep time (TST) in <a class="reference internal" href="generated/yasa.sleep_statistics.html#yasa.sleep_statistics" title="yasa.sleep_statistics"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.sleep_statistics()</span></code></a>. Previously, YASA calculated TST as SPT - WASO, thus including Art and Uns. TST is now calculated as the sum of all REM and NREM sleep in SPT.</p>
<p><strong>New FAQ</strong></p>
<p>The online documentation now has a brand new FAQ section! Make sure to check it out at <a class="reference external" href="https://raphaelvallat.com/yasa/build/html/faq.html">https://raphaelvallat.com/yasa/build/html/faq.html</a></p>
<p><strong>New function: coincidence matrix</strong></p>
<p>We have added the <a class="reference internal" href="generated/yasa.SpindlesResults.html#yasa.SpindlesResults.get_coincidence_matrix" title="yasa.SpindlesResults.get_coincidence_matrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yasa.SpindlesResults.get_coincidence_matrix()</span></code></a> and <a class="reference internal" href="generated/yasa.SWResults.html#yasa.SWResults.get_coincidence_matrix" title="yasa.SWResults.get_coincidence_matrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yasa.SWResults.get_coincidence_matrix()</span></code></a> methods to calculate the (scaled) coincidence matrix.
The coincidence matrix gives, for each pair of channel, the number of samples that were marked as an event (spindles or slow-waves) in both channels. In other words, it gives an indication of whether events (spindles or slow-waves) are co-occuring for any pair of channel.
The scaled version of the coincidence matrix can then be used to define functional networks or quickly find outlier channels.</p>
<p><strong>Minor enhancements</strong></p>
<ol class="loweralpha simple">
<li><p>Minor speed improvements in <a class="reference internal" href="generated/yasa.SleepStaging.html#yasa.SleepStaging" title="yasa.SleepStaging"><code class="xref py py-class docutils literal notranslate"><span class="pre">yasa.SleepStaging</span></code></a>.</p></li>
<li><p>Updated dependency to pyRiemann&gt;=0.2.7, which solves the version conflict with scikit-learn (see <a class="reference external" href="https://github.com/raphaelvallat/yasa/issues/33">issue 33</a>).</p></li>
<li><p>flake8 requirements for max line length has been changed from 80 to 100 characters.</p></li>
</ol>
</div>
<hr class="docutils" />
<div class="section" id="v0-4-1-march-2021">
<h2><a class="toc-backref" href="#id14">v0.4.1 (March 2021)</a><a class="headerlink" href="#v0-4-1-march-2021" title="Permalink to this headline">¶</a></h2>
<p><strong>New functions</strong></p>
<ol class="loweralpha simple">
<li><p>Added <a class="reference internal" href="generated/yasa.topoplot.html#yasa.topoplot" title="yasa.topoplot"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.topoplot()</span></code></a>, a wrapper around <a class="reference external" href="https://mne.tools/stable/generated/mne.viz.plot_topomap.html#mne.viz.plot_topomap" title="(in MNE v1.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.viz.plot_topomap()</span></code></a>. See <a class="reference external" href="https://github.com/raphaelvallat/yasa/blob/master/notebooks/15_topoplot.ipynb">15_topoplot.ipynb</a></p></li>
</ol>
<p><strong>Enhancements</strong></p>
<ol class="loweralpha simple">
<li><p>The default frequency range for slow-waves in <a class="reference internal" href="generated/yasa.sw_detect.html#yasa.sw_detect" title="yasa.sw_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.sw_detect()</span></code></a> is now 0.3-1.5 Hz instead of 0.3-2 Hz. Indeed, most slow-waves have a frequency below 1Hz. This may result in slightly different coupling values when <code class="docutils literal notranslate"><span class="pre">coupling=True</span></code> so make sure to homogenize your slow-waves detection pipeline across all nights in your dataset.</p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.trimbothstd()</span></code> now handles missing values in input array.</p></li>
<li><p><a class="reference internal" href="generated/yasa.bandpower_from_psd.html#yasa.bandpower_from_psd" title="yasa.bandpower_from_psd"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.bandpower_from_psd()</span></code></a> and <a class="reference internal" href="generated/yasa.bandpower_from_psd_ndarray.html#yasa.bandpower_from_psd_ndarray" title="yasa.bandpower_from_psd_ndarray"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.bandpower_from_psd_ndarray()</span></code></a> now print a warning if the PSD contains negative values. See <a class="reference external" href="https://github.com/raphaelvallat/yasa/issues/29">issue 29</a>.</p></li>
<li><p>Upon loading, YASA will now use the <a class="reference external" href="https://github.com/alexmojaki/outdated">outdated</a> package to check and warn the user if a newer stable version is available.</p></li>
<li><p>YASA now uses the <a class="reference external" href="https://github.com/raphaelvallat/antropy">antropy</a> package to calculate non-linear features in the automatic sleep staging module. Previously, YASA was using <a class="reference external" href="https://github.com/raphaelvallat/entropy">EntroPy</a>, which could not be installed using pip.</p></li>
</ol>
</div>
<hr class="docutils" />
<div class="section" id="v0-4-0-november-2020">
<h2><a class="toc-backref" href="#id15">v0.4.0 (November 2020)</a><a class="headerlink" href="#v0-4-0-november-2020" title="Permalink to this headline">¶</a></h2>
<p>This is a major release with several new functions, the biggest of which is the addition of an <strong>automatic sleep staging module</strong> (<a class="reference internal" href="generated/yasa.SleepStaging.html#yasa.SleepStaging" title="yasa.SleepStaging"><code class="xref py py-class docutils literal notranslate"><span class="pre">yasa.SleepStaging</span></code></a>). This means that YASA can now automatically score the sleep stages of your raw EEG data. The classifier was trained and validated on more than 3000 nights from the <a class="reference external" href="https://sleepdata.org/">National Sleep Research Resource (NSRR)</a> website.</p>
<p>Briefly, the algorithm works by calculating a set of features for each 30-sec epochs from a central EEG channel (required), as well as an EOG channel (optional) and an EMG channel (optional). For best performance, users can also specify the age and the sex of the participants. Pre-trained classifiers are already included in YASA. The automatic sleep staging algorithm requires the <a class="reference external" href="https://lightgbm.readthedocs.io/en/latest/Installation-Guide.html">LightGBM</a> and <a class="reference external" href="https://github.com/raphaelvallat/antropy">antropy</a> package.</p>
<p><strong>Other changes</strong></p>
<ol class="loweralpha simple">
<li><p><a class="reference internal" href="generated/yasa.SpindlesResults.html#yasa.SpindlesResults" title="yasa.SpindlesResults"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yasa.SpindlesResults()</span></code></a> and <a class="reference internal" href="generated/yasa.SWResults.html#yasa.SWResults" title="yasa.SWResults"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yasa.SWResults()</span></code></a> now have a <code class="docutils literal notranslate"><span class="pre">plot_detection</span></code> method which allows to interactively display the raw data with an overlay of the detected spindles. For now, this only works with Jupyter and it requires the <a class="reference external" href="https://ipywidgets.readthedocs.io/en/latest/user_install.html">ipywidgets</a> package.</p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">hue</span></code> input parameter to <a class="reference internal" href="generated/yasa.SpindlesResults.html#yasa.SpindlesResults.plot_average" title="yasa.SpindlesResults.plot_average"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yasa.SpindlesResults.plot_average()</span></code></a>, <a class="reference internal" href="generated/yasa.SWResults.html#yasa.SWResults.plot_average" title="yasa.SWResults.plot_average"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yasa.SWResults.plot_average()</span></code></a> to allow plotting by stage.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">get_sync_events()</span></code> method now also returns the sleep stage when available.</p></li>
<li><p>The <a class="reference internal" href="generated/yasa.sw_detect.html#yasa.sw_detect" title="yasa.sw_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.sw_detect()</span></code></a> now also returns the timestamp of the sigma peak in the SW-through-locked 4-seconds epochs. The timestamp is expressed in seconds from the beginning of the recording and can be found in the <code class="docutils literal notranslate"><span class="pre">SigmaPeak</span></code> column.</p></li>
</ol>
<p><strong>Dependencies</strong></p>
<ol class="loweralpha simple">
<li><p>Switch to latest version of <a class="reference external" href="https://etiennecmb.github.io/tensorpac/index.html">TensorPAC</a>.</p></li>
<li><p>Added <a class="reference external" href="https://ipywidgets.readthedocs.io/en/latest/user_install.html">ipywidgets</a>, <a class="reference external" href="https://lightgbm.readthedocs.io/en/latest/Installation-Guide.html">LightGBM</a> and <a class="reference external" href="https://github.com/raphaelvallat/entropy">entropy</a> to dependencies.</p></li>
</ol>
</div>
<hr class="docutils" />
<div class="section" id="v0-3-0-may-2020">
<h2><a class="toc-backref" href="#id16">v0.3.0 (May 2020)</a><a class="headerlink" href="#v0-3-0-may-2020" title="Permalink to this headline">¶</a></h2>
<p>This is a major release with several API-breaking changes in the spindles, slow-waves and REMs detection.</p>
<p>First, the <code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.spindles_detect_multi()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.sw_detect_multi()</span></code> have been removed. Instead, the <a class="reference internal" href="generated/yasa.spindles_detect.html#yasa.spindles_detect" title="yasa.spindles_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.spindles_detect()</span></code></a> and <a class="reference internal" href="generated/yasa.sw_detect.html#yasa.sw_detect" title="yasa.sw_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.sw_detect()</span></code></a> functions can now handle both single and multi-channel data.</p>
<p>Second, I was getting some feedback that it was difficult to get summary statistics from the detection dataframe. For instance, how can you get the average duration of the detected spindles, per channel and/or per stage? Similarly, how can you get the slow-waves count and density per stage and channel? To address these issues, I’ve now modified the output of the <a class="reference internal" href="generated/yasa.spindles_detect.html#yasa.spindles_detect" title="yasa.spindles_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.spindles_detect()</span></code></a>, <a class="reference internal" href="generated/yasa.sw_detect.html#yasa.sw_detect" title="yasa.sw_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.sw_detect()</span></code></a> and <a class="reference internal" href="generated/yasa.rem_detect.html#yasa.rem_detect" title="yasa.rem_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.rem_detect()</span></code></a> functions, which is now a class (= object) and not a simple Pandas DataFrame. The advantage is that the new output allows you to quickly get the raw data or summary statistics grouped by channel and/or sleep stage using the <code class="docutils literal notranslate"><span class="pre">.summary()</span></code> method.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">yasa</span><span class="o">.</span><span class="n">spindles_detect</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>  <span class="c1"># Returns the full detection dataframe</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">grp_chan</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grp_stage</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Similarly, the <code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.get_bool_vector()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.get_sync_events()</span></code> functions are now directly implemented into the output, i.e.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sw</span> <span class="o">=</span> <span class="n">yasa</span><span class="o">.</span><span class="n">sw_detect</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sw</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sw</span><span class="o">.</span><span class="n">get_mask</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sw</span><span class="o">.</span><span class="n">get_sync_events</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="s1">&#39;NegPeak&#39;</span><span class="p">,</span> <span class="n">time_before</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">time_after</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
<p>One can also quickly plot an average “template” of all the detected events:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sw</span><span class="o">.</span><span class="n">plot_average</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="s2">&quot;NegPeak&quot;</span><span class="p">,</span> <span class="n">time_before</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">time_after</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
<p>For more details, please refer to the documentation of <a class="reference internal" href="generated/yasa.SpindlesResults.html#yasa.SpindlesResults" title="yasa.SpindlesResults"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yasa.SpindlesResults()</span></code></a>, <a class="reference internal" href="generated/yasa.SWResults.html#yasa.SWResults" title="yasa.SWResults"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yasa.SWResults()</span></code></a> and <a class="reference internal" href="generated/yasa.REMResults.html#yasa.REMResults" title="yasa.REMResults"><code class="xref py py-meth docutils literal notranslate"><span class="pre">yasa.REMResults()</span></code></a>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This is an experimental feature, and it’s likely that these functions will be modified, renamed, or even deprecated in future releases based on feedbacks from users. Please make sure to let me know what you think about the new output of the detection functions!</p>
</div>
<p><strong>Other changes</strong></p>
<ol class="loweralpha simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">coupling</span></code> argument has been removed from the <a class="reference internal" href="generated/yasa.spindles_detect.html#yasa.spindles_detect" title="yasa.spindles_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.spindles_detect()</span></code></a> function. Instead, slow-oscillations / sigma coupling can only be calculated from the slow-waves detection, which is 1) the most standard way, 2) better because PAC assumptions require a strong oscillatory component in the lower frequency range (slow-oscillations). This also avoids unecessary confusion between spindles-derived coupling and slow-waves-derived coupling. For more details, refer to the Jupyter notebooks.</p></li>
<li><p>Downsampling of data in detection functions has been removed. In other words, YASA will no longer downsample the data to 100 / 128 Hz before applying the events detection. If the detection is too slow, we recommend that you manually downsample your data before applying the detection. See for example <a class="reference external" href="https://mne.tools/stable/generated/mne.filter.resample.html#mne.filter.resample" title="(in MNE v1.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne.filter.resample()</span></code></a>.</p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.trimbothstd()</span></code> can now work with multi-dimensional arrays. The trimmed standard deviation will always be calculated on the last axis of the array.</p></li>
<li><p>Filtering and Hilbert transform are now applied at once on all channels (instead of looping across individual channels) in the <a class="reference internal" href="generated/yasa.spindles_detect.html#yasa.spindles_detect" title="yasa.spindles_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.spindles_detect()</span></code></a> and <a class="reference internal" href="generated/yasa.sw_detect.html#yasa.sw_detect" title="yasa.sw_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.sw_detect()</span></code></a> functions. This should lead to some improvements in computation time.</p></li>
</ol>
</div>
<hr class="docutils" />
<div class="section" id="older-versions">
<h2><a class="toc-backref" href="#id17">Older versions</a><a class="headerlink" href="#older-versions" title="Permalink to this headline">¶</a></h2>
<details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
<strong>v0.2.0 (April 2020)</strong><div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<p class="card-text">This is a major release with several new functions, bugfixes and miscellaneous enhancements in existing functions.</p>
<p class="card-text"><strong>Bugfixes</strong></p>
<ol class="loweralpha simple">
<li><p class="card-text">Sleep efficiency in the <a class="reference internal" href="generated/yasa.sleep_statistics.html#yasa.sleep_statistics" title="yasa.sleep_statistics"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.sleep_statistics()</span></code></a> is now calculated using time in bed (TIB) as the denominator instead of sleep period time (SPT), in agreement with the AASM guidelines. The old way of computing the efficiency (TST / SPT) has now been renamed Sleep Maintenance Efficiency (SME).</p></li>
<li><p class="card-text">The <a class="reference internal" href="generated/yasa.sliding_window.html#yasa.sliding_window" title="yasa.sliding_window"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.sliding_window()</span></code></a> now always return an array of shape (n_epochs, …, n_samples), i.e. the epochs are now always the first dimension of the epoched array. This is consistent with MNE default shape of <a class="reference external" href="https://mne.tools/stable/generated/mne.Epochs.html#mne.Epochs" title="(in MNE v1.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">mne.Epochs</span></code></a> objects.</p></li>
</ol>
<p class="card-text"><strong>New functions</strong></p>
<ol class="loweralpha simple">
<li><p class="card-text">Added <a class="reference internal" href="generated/yasa.art_detect.html#yasa.art_detect" title="yasa.art_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.art_detect()</span></code></a> to automatically detect artefacts on single or multi-channel EEG data.</p></li>
<li><p class="card-text">Added <a class="reference internal" href="generated/yasa.bandpower_from_psd_ndarray.html#yasa.bandpower_from_psd_ndarray" title="yasa.bandpower_from_psd_ndarray"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.bandpower_from_psd_ndarray()</span></code></a> to calculate band power from a multi-dimensional PSD. This is a NumPy-only implementation and this function will return a np.array and not a pandas DataFrame. This function is useful if you need to calculate the bandpower from a 3-D PSD array, e.g. of shape <em>(n_epochs, n_chan, n_freqs)</em>.</p></li>
<li><p class="card-text">Added <code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.get_centered_indices()</span></code> to extract indices in data centered around specific events or peaks.</p></li>
<li><p class="card-text">Added <a class="reference internal" href="generated/yasa.load_profusion_hypno.html#yasa.load_profusion_hypno" title="yasa.load_profusion_hypno"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.load_profusion_hypno()</span></code></a> to load a Compumedics Profusion hypnogram (.xml), as found on the <a class="reference external" href="https://sleepdata.org/">National Sleep Research Resource (NSRR)</a> website.</p></li>
</ol>
<p class="card-text"><strong>Enhancements</strong></p>
<ol class="loweralpha simple">
<li><p class="card-text"><a class="reference internal" href="generated/yasa.sleep_statistics.html#yasa.sleep_statistics" title="yasa.sleep_statistics"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.sleep_statistics()</span></code></a> now also returns the sleep onset latency, i.e. the latency to the first epoch of any sleep.</p></li>
<li><p class="card-text">Added the <cite>bandpass</cite> argument to <a class="reference internal" href="generated/yasa.bandpower.html#yasa.bandpower" title="yasa.bandpower"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.bandpower()</span></code></a> to apply a FIR bandpass filter using the lowest and highest frequencies defined in <cite>bands</cite>. This is useful if you work with absolute power and want to remove contributions from frequency bands of non-interests.</p></li>
<li><p class="card-text">The <a class="reference internal" href="generated/yasa.bandpower_from_psd.html#yasa.bandpower_from_psd" title="yasa.bandpower_from_psd"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.bandpower_from_psd()</span></code></a> now always return the total absolute physical power (<cite>TotalAbsPow</cite>) of the signal, in units of uV^2 / Hz. This allows to quickly calculate the absolute bandpower from the relative bandpower.</p></li>
<li><p class="card-text">Added sigma (12-16Hz) to the default frequency bands (<cite>bands</cite>) in <a class="reference internal" href="generated/yasa.bandpower.html#yasa.bandpower" title="yasa.bandpower"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.bandpower()</span></code></a> and <a class="reference internal" href="generated/yasa.bandpower_from_psd.html#yasa.bandpower_from_psd" title="yasa.bandpower_from_psd"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.bandpower_from_psd()</span></code></a>.</p></li>
<li><p class="card-text">Added the <code class="docutils literal notranslate"><span class="pre">coupling</span></code> and <code class="docutils literal notranslate"><span class="pre">freq_sp</span></code> keyword-arguments to the <a class="reference internal" href="generated/yasa.sw_detect.html#yasa.sw_detect" title="yasa.sw_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.sw_detect()</span></code></a> function. If <code class="docutils literal notranslate"><span class="pre">coupling=True</span></code>, the function will return the phase of the slow-waves (in radians) at the most prominent peak of sigma-filtered band (<code class="docutils literal notranslate"><span class="pre">PhaseAtSigmaPeak</span></code>), as well as the normalized mean vector length (<code class="docutils literal notranslate"><span class="pre">ndPAC</span></code>).</p></li>
<li><p class="card-text">Added an section in the <a class="reference external" href="https://github.com/raphaelvallat/yasa/blob/master/notebooks/06_sw_detection.ipynb">06_sw_detection.ipynb</a> notebooks on how to use relative amplitude thresholds (e.g. z-scores or percentiles) instead of absolute thresholds in slow-waves detection.</p></li>
<li><p class="card-text">The upper frequency band for <a class="reference internal" href="generated/yasa.sw_detect.html#yasa.sw_detect" title="yasa.sw_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.sw_detect()</span></code></a> has been changed from <code class="docutils literal notranslate"><span class="pre">freq_sw=(0.3,</span> <span class="pre">3.5)</span></code> to <code class="docutils literal notranslate"><span class="pre">freq_sw=(0.3,</span> <span class="pre">2)</span></code> Hz to comply with AASM guidelines.</p></li>
<li><p class="card-text"><code class="docutils literal notranslate"><span class="pre">Stage</span></code> is no longer taken into account when finding outliers with <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.IsolationForest.html#sklearn.ensemble.IsolationForest" title="(in scikit-learn v1.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.ensemble.IsolationForest</span></code></a> in <a class="reference internal" href="generated/yasa.spindles_detect.html#yasa.spindles_detect" title="yasa.spindles_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.spindles_detect()</span></code></a>.</p></li>
<li><p class="card-text">To be consistent with <a class="reference internal" href="generated/yasa.spindles_detect.html#yasa.spindles_detect" title="yasa.spindles_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.spindles_detect()</span></code></a>, automatic outlier removal now requires at least 50 (instead of 100) detected events in <a class="reference internal" href="generated/yasa.sw_detect.html#yasa.sw_detect" title="yasa.sw_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.sw_detect()</span></code></a> and <a class="reference internal" href="generated/yasa.rem_detect.html#yasa.rem_detect" title="yasa.rem_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.rem_detect()</span></code></a>.</p></li>
<li><p class="card-text">Added the <code class="docutils literal notranslate"><span class="pre">verbose</span></code> parameter to all detection functions.</p></li>
<li><p class="card-text">Added -2 to the default hypnogram format to denote unscored data.</p></li>
</ol>
<p class="card-text"><strong>Dependencies</strong></p>
<ol class="loweralpha simple">
<li><p class="card-text">Removed deprecated <code class="docutils literal notranslate"><span class="pre">behavior</span></code> argument to avoid warning when calling <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.IsolationForest.html#sklearn.ensemble.IsolationForest" title="(in scikit-learn v1.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.ensemble.IsolationForest</span></code></a>.</p></li>
<li><p class="card-text">Added <a class="reference external" href="https://etiennecmb.github.io/tensorpac/index.html">TensorPAC</a> and <a class="reference external" href="https://pyriemann.readthedocs.io/en/latest/api.html">pyRiemann</a> to dependencies.</p></li>
<li><p class="card-text">Updated dependencies version for MNE and scikit-learn.</p></li>
</ol>
</div>
</details><details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
<strong>v0.1.9 (February 2020)</strong><div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<p class="card-text"><strong>New functions</strong></p>
<ol class="loweralpha simple">
<li><p class="card-text">Added <a class="reference internal" href="generated/yasa.transition_matrix.html#yasa.transition_matrix" title="yasa.transition_matrix"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.transition_matrix()</span></code></a> to calculate the state-transition matrix of an hypnogram.</p></li>
<li><p class="card-text">Added <a class="reference internal" href="generated/yasa.sleep_statistics.html#yasa.sleep_statistics" title="yasa.sleep_statistics"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.sleep_statistics()</span></code></a> to extract the sleep statistics from an hypnogram.</p></li>
<li><p class="card-text">Added the <code class="docutils literal notranslate"><span class="pre">coupling</span></code> and <code class="docutils literal notranslate"><span class="pre">freq_so</span></code> keyword-arguments to the <a class="reference internal" href="generated/yasa.spindles_detect.html#yasa.spindles_detect" title="yasa.spindles_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.spindles_detect()</span></code></a> function. If <code class="docutils literal notranslate"><span class="pre">coupling=True</span></code>, the function will also returns the phase of the slow-waves (in radians) at the most prominent peak of the spindles. This can be used to perform spindles-SO coupling, as explained in the new Jupyter notebooks on PAC and spindles-SO coupling.</p></li>
</ol>
<p class="card-text"><strong>Enhancements</strong></p>
<ol class="loweralpha simple">
<li><p class="card-text">It is now possible to disable one or two out of the three thresholds in the <a class="reference internal" href="generated/yasa.spindles_detect.html#yasa.spindles_detect" title="yasa.spindles_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.spindles_detect()</span></code></a>. This allows the users to run a simpler detection (for example focusing exclusively on the moving root mean square signal).</p></li>
<li><p class="card-text">The <a class="reference internal" href="generated/yasa.spindles_detect.html#yasa.spindles_detect" title="yasa.spindles_detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.spindles_detect()</span></code></a> now returns the timing (in seconds) of the most prominent peak of each spindles (<code class="docutils literal notranslate"><span class="pre">Peak</span></code>).</p></li>
<li><p class="card-text">The yasa.get_sync_sw has been renamed to <code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.get_sync_events()</span></code> and is now compatible with spindles detection. This can be used for instance to plot the peak-locked grand averaged spindle.</p></li>
</ol>
<p class="card-text"><strong>Code testing</strong></p>
<ol class="loweralpha simple">
<li><p class="card-text">Removed Travis and AppVeyor testing for Python 3.5.</p></li>
</ol>
</div>
</details><details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
<strong>v0.1.8 (October 2019)</strong><div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<ol class="loweralpha simple">
<li><p class="card-text">Added <a class="reference internal" href="generated/yasa.plot_spectrogram.html#yasa.plot_spectrogram" title="yasa.plot_spectrogram"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.plot_spectrogram()</span></code></a> function.</p></li>
<li><p class="card-text">Added <a class="reference external" href="https://github.com/hbldh/lspopt">lspopt</a> in the dependencies.</p></li>
<li><p class="card-text">YASA now requires <a class="reference external" href="https://mne.tools/stable/index.html">MNE</a>&gt;0.19.</p></li>
<li><p class="card-text">Added a notebook on non-linear features.</p></li>
</ol>
</div>
</details><details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
<strong>v0.1.7 (August 2019)</strong><div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<ol class="loweralpha simple">
<li><p class="card-text">Added <a class="reference internal" href="generated/yasa.sliding_window.html#yasa.sliding_window" title="yasa.sliding_window"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.sliding_window()</span></code></a> function.</p></li>
<li><p class="card-text">Added <a class="reference internal" href="generated/yasa.irasa.html#yasa.irasa" title="yasa.irasa"><code class="xref py py-func docutils literal notranslate"><span class="pre">yasa.irasa()</span></code></a> function.</p></li>
<li><p class="card-text">Reorganized code into several sub-files for readability (internal changes with no effect on user experience).</p></li>
</ol>
</div>
</details><details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
<strong>v0.1.6 (August 2019)</strong><div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<ol class="loweralpha simple">
<li><p class="card-text">Added bandpower function</p></li>
<li><p class="card-text">One can now directly pass a raw MNE object in several multi-channel functions of YASA, instead of manually passing data, sf, and ch_names. YASA will automatically convert MNE data from Volts to uV, and extract the sampling frequency and channel names. Examples of this can be found in the Jupyter notebooks examples.</p></li>
</ol>
</div>
</details><details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
<strong>v0.1.5 (August 2019)</strong><div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<ol class="loweralpha simple">
<li><p class="card-text">Added REM detection (rem_detect) on LOC and ROC EOG channels + example notebook</p></li>
<li><p class="card-text">Added yasa/hypno.py file, with several functions to load and upsample sleep stage vector (hypnogram).</p></li>
<li><p class="card-text">Added yasa/spectral.py file, which includes the bandpower_from_psd function to calculate the single or multi-channel spectral power in specified bands from a pre-computed PSD (see example notebook at notebooks/10_bandpower.ipynb)</p></li>
</ol>
</div>
</details><details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
<strong>v0.1.4 (May 2019)</strong><div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<ol class="loweralpha simple">
<li><p class="card-text">Added get_sync_sw function to get the synchronized timings of landmarks timepoints in slow-wave sleep. This can be used in combination with seaborn.lineplot to plot an average template of the detected slow-wave, per channel.</p></li>
</ol>
</div>
</details><details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
<strong>v0.1.3 (March 2019)</strong><div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<ol class="loweralpha simple">
<li><p class="card-text">Added slow-waves detection for single and multi channel</p></li>
<li><p class="card-text">Added include argument to select which values of hypno should be used as a mask.</p></li>
<li><p class="card-text">New examples notebooks + changes in README</p></li>
<li><p class="card-text">Minor improvements in performance (e.g. faster detrending)</p></li>
<li><p class="card-text">Added html API (/html)</p></li>
<li><p class="card-text">Travis and AppVeyor test for Python 3.5, 3.6 and 3.7</p></li>
</ol>
</div>
</details><details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
<strong>v0.1.2 (February 2019)</strong><div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<ol class="loweralpha simple">
<li><p class="card-text">Added support for multi-channel detection via spindles_detect_multi function.</p></li>
<li><p class="card-text">Added support for hypnogram mask</p></li>
<li><p class="card-text">Added several notebook examples</p></li>
<li><p class="card-text">Changed some default parameters to optimize behavior</p></li>
</ol>
</div>
</details><details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
<strong>v0.1.1 (January 2019)</strong><div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<ol class="loweralpha simple">
<li><p class="card-text">Added post-processing Isolation Forest</p></li>
<li><p class="card-text">Updated Readme and added support with Visbrain</p></li>
<li><p class="card-text">Added Cz full night in notebooks/</p></li>
</ol>
</div>
</details><details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
<strong>v0.1 (December 2018)</strong><div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<p class="card-text">Initial release of YASA: basic spindles detection.</p>
</div>
</details></div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
        &copy; Copyright 2018-2022, Dr. Raphael Vallat, Center for Human Sleep Science, UC Berkeley.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>